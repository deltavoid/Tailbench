

xapian integrated test

本次在集成模式下对xapian进行了简单的测试。
测试数据如下：

WARMUPREQS = 1000
单位ms

    QPS    REQUESTS    Latency 95%ile    Latency max
                       (ms)              (ms)
    200    1000        8.097             15.148
                       7.842             15.505
                       8.324             14.935
                       8.057             14.946
                       7.335             13.523
    400    2000        5.465             13.069
                       5.790             16.607
                       6.066             15.882
                       5.891             15.712
                       6.860             23.691
    600    3000        5.786             14.937
                       4,820             19.038
                       4.908             14.935
                       6.269             15.994
                       5.780             15.831
    800    4000        6.292             21.046
                       4.298             17.031
                       5.412             13.241
                       4.986             26.390
                       5.832             33.756
    1000   5000        7.118             20.467
                       6.359             17.958
                       7.298             18.303
                       8.588             17.120
                       8.690             19.221
    1200   6000        29.541            71.208
                       13.002            23.705
                       16.872            32.567
                       10.103            20.468
                       18.983            28.304
    1400    7000       281.025           274.593
                       43.945            61.771
                       64.929            76.977
                       75.059            90.589
                       82.903            102.141
    1600    8000       346.702           410.311
                       786.526           826.889
                       742.196           784.011
                       697.164           728.218
                       707.755           754.353

分析：
    本次测试QPS(每秒请求数)从200到1600，每隔200取一个点，每个点测试5次。
    从测试结果可以看出，QPS从200到1000时，增长较为缓慢，从1200开始快速增长，这个趋势与论文结果是符合的。
    有一个比较奇怪的地方是QPS=200时的尾延迟比QPS=400时的尾延迟要大，QPS减少时，尾延迟反而增大，这不符合整体趋势，暂时猜测原因是美妙请求数太少，进程经常被换入换出影响了效率。
